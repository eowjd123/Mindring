# 퍼즐 랭킹 시스템 설계

## 1. 점수 계산 로직

### 점수 공식
```
점수 = (기본 점수 × 난이도 보너스) - (시간 페널티) - (이동 횟수 페널티)

기본 점수: 1000점
난이도 보너스:
  - 4조각 (1단계): 1.0배
  - 9조각 (2단계): 1.5배
  - 16조각 (3단계): 2.0배
  - 36조각 (4단계): 3.0배

시간 페널티: 완료 시간(초) × 2
이동 횟수 페널티: 이동 횟수 × 1

최종 점수 = (1000 × 난이도보너스) - (시간 × 2) - (이동횟수 × 1)
```

### 예시
- 16조각 퍼즐을 120초, 50번 이동으로 완료
- 점수 = (1000 × 2.0) - (120 × 2) - (50 × 1) = 2000 - 240 - 50 = 1710점

## 2. 데이터베이스 모델

이미 `PuzzleRecord` 모델이 추가되어 있습니다:
- recordId: 기록 ID
- userId: 사용자 ID
- puzzleId: 퍼즐 이미지 ID
- difficulty: 난이도 (4, 9, 16, 36)
- completionTime: 완료 시간 (초)
- moves: 이동 횟수
- score: 계산된 점수
- completed: 완료 여부
- completedAt: 완료 시각

## 3. API 엔드포인트

### 3.1 퍼즐 기록 저장 (POST /api/puzzles/records)
퍼즐 완료 시 기록 저장

### 3.2 랭킹 조회 (GET /api/puzzles/rankings)
- 전체 랭킹
- 개인 최고 기록
- 특정 퍼즐 랭킹
- 난이도별 랭킹

## 4. UI 컴포넌트

### 4.1 퍼즐 완료 팝업에 추가
- 개인 최고 기록 표시
- 전체 랭킹 순위 표시
- 랭킹 보기 버튼

### 4.2 랭킹 페이지 (/puzzle-home/rankings)
- 전체 랭킹
- 난이도별 랭킹
- 퍼즐별 랭킹
- 개인 기록

## 5. 구현 순서

1. 점수 계산 유틸 함수 작성
2. 퍼즐 완료 시 기록 저장 API 구현
3. 랭킹 조회 API 구현
4. 퍼즐 완료 팝업에 랭킹 정보 추가
5. 랭킹 페이지 구현

